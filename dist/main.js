(()=>{"use strict";const e=e=>{if(e<2||e>5)return;const t=new Array(e);for(let e=0;e<t.length;e++)t[e]=!1;return{id:void 0,axis:void 0,firstRow:void 0,firstColumn:void 0,length:e,hit:e=>{t[e]=!0},isSunk:()=>{for(let e=0;e<t.length;e++)if(!1===t[e])return!1;return!0}}},t=(e,t)=>Math.floor(Math.random()*(t-e))+e,n=()=>["x","y"][t(0,2)],o=e=>{let t,n;const o=e.toString();return 1===o.length?(t=0,n=Number(o[0])):2===o.length&&(t=Number(o[0]),n=Number(o[1])),[t,n]},r=o=>{const r=(e=>{const t=new Array(e);for(let n=0;n<t.length;n++)t[n]=new Array(e).fill("");let n=[],o=[];return{rows:t,allShips:n,missedShots:o,placeShip:(o,r,l,s)=>{if(o.axis=r,o.firstRow=l,o.firstColumn=s,(t=>{if("x"===t.axis){if(t.firstColumn+t.length-1>=e)return!0}else if("y"===t.axis&&t.firstRow+t.length-1>=e)return!0;return!1})(o)||(e=>{if("x"===e.axis){const n=e.firstRow,o=e.firstColumn+e.length-1;for(let r=e.firstColumn;r<=o;r++)if(""!=t[n][r])return!0}else if("y"===e.axis){const n=e.firstRow+e.length-1,o=e.firstColumn;for(let r=e.firstRow;r<=n;r++)if(""!=t[r][o])return!0}return!1})(o))return"Invalid position";if(n.push(o),o.id=n.length-1,"x"===r){const e=l,n=s+o.length-1;for(let r=s;r<=n;r++)t[e][r]=`S${o.id}`}else if("y"===r){const e=s,n=l+o.length-1;for(let r=l;r<=n;r++)t[r][e]=`S${o.id}`}},receiveAttack:(e,r)=>{const l=t[e][r];if("S"===l[0]){const o=l.slice(1),s=n[o];t[e][r]=`X${o}`;const a=((e,t,n)=>{const o=n.firstRow,r=n.firstColumn;let l=0;if("x"===n.axis){const e=r+n.length-1;for(let n=r;n<=e;n++){if(n===t)return l;l++}}else if("y"===n.axis){const t=o+n.length-1;for(let n=o;n<=t;n++){if(n===e)return l;l++}}})(e,r,s);return s.hit(a),"Success!"}{const t=((e,t)=>({row:e,column:t}))(e,r);return o.push(t),"Missed"}},allShipsSunk:()=>{for(let e=0;e<n.length;e++)if(!1===n[e].isSunk())return!1;return!0}}})(10),l=[],s=(e,t,n)=>{if(l.push([t,n]),e.receiveAttack(t,n),e.allShipsSunk())return`${o} won!`};return{name:o,board:r,allPlays:l,attackEnemyBoard:s,placeShipsRandomly:()=>{const o=[e(5),e(4),e(3),e(3),e(2)];for(let e=0;e<o.length;e++){const l=o[e],s=n(),a=t(0,10),i=t(0,10);let c=r.placeShip(l,s,a,i);for(;"Invalid position"===c;){const e=n(),o=t(0,10),s=t(0,10);c=r.placeShip(l,e,o,s)}}},randomPlay:e=>{let n=t(0,10),o=t(0,10);for(;l.includes([n,o]);)n=t(0,10),o=t(0,10);s(e,n,o)}}},l=(e,t,n,r)=>{const l=o(t)[0],s=o(t)[1];"Success!"===n.board.receiveAttack(l,s)&&(e.style.backgroundColor="red"),e.textContent="X",n.board.allShipsSunk()&&console.log(`${r.name} won!`)},s=()=>{const e=document.getElementById("player-name").value;if("computer"===e.toLowerCase())return alert("C'mon, you're not the computer! Try again."),void(document.getElementById("player-name").value="");const t=r(e),n=r("Computer");t.placeShipsRandomly(),n.placeShipsRandomly(),console.log(n.board.allShips),(e=>{document.getElementById("new-game").style.display="none";const t=document.getElementById("container");t.style.display="grid";const n=document.createElement("div");n.textContent=`${e.name}'s board`,t.append(n);const o=document.createElement("div");o.textContent="Computer's board",t.append(o);const r=document.createElement("div");r.className="board",r.id="player-board";const l=document.createElement("div");l.className="board",l.id="computer-board";const s=[r,l];for(let e=0;e<s.length;e++){const n=s[e];t.append(n),n.style.display="grid";for(let e=0;e<100;e++){const e=document.createElement("div");e.className="square",n.append(e)}}(e=>{(()=>{const e=document.getElementsByClassName("square");for(let t=0;t<e.length;t++)e[t].style.backgroundColor=""})();const t=e.board.allShips,n=document.getElementsByClassName("square"),o=[];if("computer"===e.name.toLowerCase())for(let e=100;e<200;e++)o.push(n[e]);else for(let e=0;e<100;e++)o.push(n[e]);for(let e=0;e<t.length;e++){const n=t[e],r=10*n.firstRow+n.firstColumn;let l;"x"===n.axis?l=r+n.length-1:"y"===n.axis&&(l=r+10*n.length-1);let s=r;for(;s<=l;)o[s].style.backgroundColor="green","x"===n.axis?s++:"y"===n.axis&&(s+=10)}})(e)})(t);const o=document.getElementsByClassName("square");for(let e=100;e<o.length;e++){const r=o[e];r.addEventListener("click",(()=>{"X"!==r.textContent&&l(r,e-100,n,t)}))}};document.getElementById("new-game-btn").addEventListener("click",(()=>{s()}))})();