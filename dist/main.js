(()=>{"use strict";const t=t=>{if(t<2||t>5)return;const e=new Array(t);for(let t=0;t<e.length;t++)e[t]=!1;return{id:void 0,axis:void 0,firstRow:void 0,firstColumn:void 0,length:t,hit:t=>{e[t]=!0},isSunk:()=>{for(let t=0;t<e.length;t++)if(!1===e[t])return!1;return!0}}},e=(t,e)=>Math.floor(Math.random()*(e-t))+t,n=()=>["x","y"][e(0,2)],o=t=>{let e,n;const o=t.toString();return 1===o.length?(e=0,n=Number(o[0])):2===o.length&&(e=Number(o[0]),n=Number(o[1])),[e,n]},r=(t,e)=>{const n=t,o=e;for(let t=0;t<n.length;t++){let e=0;for(let r=0;r<n[t].length;r++)n[t][r]===o[r]&&(e+=1);if(e===o.length)return!0}return!1},l=o=>{const l=(t=>{const e=new Array(t);for(let n=0;n<e.length;n++)e[n]=new Array(t).fill("");let n=[],o=[];return{rows:e,allShips:n,missedShots:o,placeShip:(o,r,l,s)=>{if(o.axis=r,o.firstRow=l,o.firstColumn=s,(e=>{if("x"===e.axis){if(e.firstColumn+e.length-1>=t)return!0}else if("y"===e.axis&&e.firstRow+e.length-1>=t)return!0;return!1})(o)||(t=>{if("x"===t.axis){const n=t.firstRow,o=t.firstColumn+t.length-1;for(let r=t.firstColumn;r<=o;r++)if(""!=e[n][r])return!0}else if("y"===t.axis){const n=t.firstRow+t.length-1,o=t.firstColumn;for(let r=t.firstRow;r<=n;r++)if(""!=e[r][o])return!0}return!1})(o))return"Invalid position";if(n.push(o),o.id=n.length-1,"x"===r){const t=l,n=s+o.length-1;for(let r=s;r<=n;r++)e[t][r]=`S${o.id}`}else if("y"===r){const t=s,n=l+o.length-1;for(let r=l;r<=n;r++)e[r][t]=`S${o.id}`}},receiveAttack:(t,r)=>{const l=e[t][r];if("S"===l[0]){const o=l.slice(1),s=n[o];e[t][r]=`X${o}`;const a=((t,e,n)=>{const o=n.firstRow,r=n.firstColumn;let l=0;if("x"===n.axis){const t=r+n.length-1;for(let n=r;n<=t;n++){if(n===e)return l;l++}}else if("y"===n.axis){const e=o+n.length-1;for(let n=o;n<=e;n++){if(n===t)return l;l++}}})(t,r,s);s.hit(a)}else{const e=((t,e)=>({row:t,column:e}))(t,r);o.push(e)}},allShipsSunk:()=>{for(let t=0;t<n.length;t++)if(!1===n[t].isSunk())return!1;return!0}}})(10),s=[],a=(t,e,n)=>{s.push([e,n]),t.receiveAttack(e,n)};return{name:o,board:l,allPlays:s,attackEnemyBoard:a,placeShipsRandomly:()=>{const o=[t(5),t(4),t(3),t(3),t(2)];for(let t=0;t<o.length;t++){const r=o[t],s=n(),a=e(0,10),i=e(0,10);let c=l.placeShip(r,s,a,i);for(;"Invalid position"===c;){const t=n(),o=e(0,10),s=e(0,10);c=l.placeShip(r,t,o,s)}}},randomPlay:t=>{let n=e(0,10),o=e(0,10);for(;r(s,[n,o]);)n=e(0,10),o=e(0,10);return a(t,n,o),[n,o]}}},s=t=>{(()=>{const t=document.getElementsByClassName("square");for(let e=0;e<t.length;e++)t[e].style.backgroundColor=""})();const e=t.board.allShips,n=document.getElementsByClassName("square"),o=[];if("computer"===t.name.toLowerCase())for(let t=100;t<200;t++)o.push(n[t]);else for(let t=0;t<100;t++)o.push(n[t]);for(let t=0;t<e.length;t++){const n=e[t],r=10*n.firstRow+n.firstColumn;let l;"x"===n.axis?l=r+n.length-1:"y"===n.axis&&(l=r+10*n.length-1);let s=r;for(;s<=l;)o[s].style.backgroundColor="green","x"===n.axis?s++:"y"===n.axis&&(s+=10)}},a=t=>{const e=`${t.name} won!`;alert(e),document.getElementById("title").textContent=e},i=(t,e,n,r)=>{const l=o(e)[0],s=o(e)[1];r.attackEnemyBoard(n.board,l,s),"X"===n.board.rows[l][s][0]&&(t.style.backgroundColor="red"),t.textContent="X",n.board.allShipsSunk()&&a(r)},c=(t,e)=>{const n=t.randomPlay(e.board),o=n[0],r=n[1];let l=o.toString()+r.toString();l=Number(l);const s=document.getElementsByClassName("square")[l];s.textContent="X","X"===e.board.rows[o][r][0]&&(s.style.backgroundColor="red"),e.board.allShipsSunk()&&a(t)},d=t=>{const e=l("Computer");e.placeShipsRandomly(),console.log(t.board.allShips),console.log(e.board.allShips);const n=document.getElementsByClassName("square");for(let o=100;o<n.length;o++){const r=n[o];r.addEventListener("click",(()=>{const n=t.board.allShipsSunk()||e.board.allShipsSunk();n||"X"!==r.textContent&&(i(r,o-100,e,t),n||c(e,t))}))}};document.getElementById("new-game-btn").addEventListener("click",(()=>{const e=document.getElementById("player-name").value;if("computer"===e.toLowerCase())return alert("C'mon, you're not the computer! Try again."),void(document.getElementById("player-name").value="");const n=l(e);(t=>{document.getElementById("new-game").style.display="none";const e=document.getElementById("container");e.style.display="grid";const n=document.createElement("div");n.className="board",n.id="player-board";const o=document.createElement("div");o.className="board",o.id="computer-board";const r=[n,o];for(let t=0;t<r.length;t++){const n=r[t];n.style.display="grid";const o=document.createElement("div"),l=document.createElement("div");l.className="board-title","player-board"===n.id?l.textContent="Place your carrier":"computer-board"===n.id&&(l.textContent="Computer's board"),o.append(l),o.append(n),e.append(o);for(let t=0;t<100;t++){const t=document.createElement("div");t.className="square",n.append(t)}}s(t)})(n),(e=>{const n=document.getElementById("toggle-btn");n.style.display="block",n.addEventListener("click",(()=>{"Horizontal"===n.textContent?n.textContent="Vertical":"Vertical"===n.textContent&&(n.textContent="Horizontal")}));const r=document.getElementsByClassName("square");for(let l=0;l<100;l++)r[l].addEventListener("click",(()=>{let r,a=e.board.allShips.length;const i=document.getElementsByClassName("board-title")[0];0===a?r=5:1===a?r=4:2===a||3===a?r=3:4===a&&(r=2);const c=t(r);let u;"Horizontal"===n.textContent?u="x":"Vertical"===n.textContent&&(u="y");const m=o(l)[0],f=o(l)[1];e.board.placeShip(c,u,m,f),s(e),console.log(e.board.allShips),a=e.board.allShips.length,1===a?i.textContent="Place your battleship":2===a?i.textContent="Place your cruiser":3===a?i.textContent="Place your submarine":4===a?i.textContent="Place your destroyer":5===a&&(i.textContent=`${e.name}'s board`,n.style.display="none",d(e))}))})(n)}))})();